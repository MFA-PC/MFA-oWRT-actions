#!/bin/bash

echo "Applying custom kernel settings..."

CONFIG_FILE="openwrt/.config"

# Добавляем параметры в конец .config, если их там нет
cat <<EOF >> $CONFIG_FILE
CONFIG_KERNEL_CGROUP_DEVICE=n
CONFIG_KERNEL_CGROUP_FREEZER=n
CONFIG_KERNEL_CGROUP_HUGETLB=n
CONFIG_KERNEL_CGROUP_NET_PRIO=n
CONFIG_KERNEL_CGROUP_PERF=n
CONFIG_KERNEL_CRYPTO_DEV_ROCKCHIP_DCP=y
CONFIG_KERNEL_CRYPTO_DEV_ROCKCHIP_RSA=y
CONFIG_KERNEL_CRYPTO_DEV_ROCKCHIP=y
CONFIG_KERNEL_CRYPTO_DRBG_MENU=y
CONFIG_KERNEL_CRYPTO_JITTERENTROPY=y
CONFIG_KERNEL_DEBUG_INFO=n
CONFIG_KERNEL_FS_SQUASHFS_ZSTD=y
CONFIG_KERNEL_FS_SQUASHFS=y
CONFIG_KERNEL_GPIO_SYSFS=y
CONFIG_KERNEL_GPIOLIB=y
CONFIG_KERNEL_HZ=500
CONFIG_KERNEL_LRNG=y
CONFIG_KERNEL_NET_CLS_CGROUP=n
CONFIG_KERNEL_NET_SCH_FQ=y
CONFIG_KERNEL_NETFILTER_XT_MATCH_SOCKET=y
CONFIG_KERNEL_NETFILTER_XT_TARGET_TPROXY=y
CONFIG_KERNEL_NETKIT=n
CONFIG_KERNEL_NF_CONNTRACK=y
CONFIG_KERNEL_PCI=y
CONFIG_KERNEL_PCIE_DPC=y
CONFIG_KERNEL_PCIEASPM=n
CONFIG_KERNEL_PCIEPORTBUS=y
CONFIG_KERNEL_PINCTRL=y
CONFIG_KERNEL_PREEMPT_VOLUNTARY=y
CONFIG_KERNEL_PRINTK_TIME=y
CONFIG_KERNEL_RANDOM_TRUST_CPU=y
CONFIG_KERNEL_SCHED_AUTOGROUP=y
CONFIG_KERNEL_SKB_FIXED_SIZE_2K=y
CONFIG_KERNEL_SKB_RECYCLE_MAX_PREALLOC_SKBS=8192
CONFIG_KERNEL_SKB_RECYCLE_SIZE=1856
CONFIG_KERNEL_SKB_RECYCLER_PREALLOC=y
CONFIG_KERNEL_TCP_CONG_BBR=y
CONFIG_KERNEL_TLS_DEVICE=n
CONFIG_KERNEL_TLS=y
CONFIG_KERNEL_TTY=y
CONFIG_KERNEL_XDP_SOCKETS=n
CONFIG_KERNEL_ZRAM=y
CONFIG_KERNEL_ZSMALLOC=y
CONFIG_LIBCURL_COOKIES=y
CONFIG_LIBCURL_CRYPTO_AUTH=y
CONFIG_LIBCURL_FILE=y
CONFIG_LIBCURL_HTTP=y
CONFIG_LIBCURL_NGHTTP2=y
CONFIG_LIBCURL_OPENSSL=y
CONFIG_LIBCURL_PROXY=y
CONFIG_LIBCURL_THREADED_RESOLVER=y
CONFIG_LIBCURL_TLS_SRP=n
CONFIG_LIBCURL_UNIX_SOCKETS=y
CONFIG_LUCI_LANG_ru=y
CONFIG_OPENSSL_ENGINE=y
CONFIG_OPENSSL_WITH_ASM=y
CONFIG_OPENSSL_WITH_CHACHA_POLY1305=y
CONFIG_OPENSSL_WITH_PSK=y
CONFIG_OPENSSL_WITH_TLS13=y
EOF

# Применяем изменения
#cd openwrt
#make oldconfig
